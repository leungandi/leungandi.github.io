<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Spring," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="数据库事务概念 数据库事务(Database Transaction) ，是指作为单个逻辑工作单元执行的一系列操作，要么完全地执行，要么完全地不执行。  相关属性   名称 解释     原子性(Atomicity) 事务必须是原子工作单元。对于其数据修改，要么全都执行，要么全都不执行   一致性(Consistency) 事务在完成时，必须使所有的数据都保持一致状态   隔离性(Isolatio">
<meta name="keywords" content="Spring">
<meta property="og:type" content="article">
<meta property="og:title" content="第七篇之Spring Transaction">
<meta property="og:url" content="http://loveyy.net/2017/06/07/编程/spring/第七篇之Spring Transaction/index.html">
<meta property="og:site_name" content="燕良山好汉的博客">
<meta property="og:description" content="数据库事务概念 数据库事务(Database Transaction) ，是指作为单个逻辑工作单元执行的一系列操作，要么完全地执行，要么完全地不执行。  相关属性   名称 解释     原子性(Atomicity) 事务必须是原子工作单元。对于其数据修改，要么全都执行，要么全都不执行   一致性(Consistency) 事务在完成时，必须使所有的数据都保持一致状态   隔离性(Isolatio">
<meta property="og:image" content="http://loveyy.net/images/spring/1/spring_transaction.jpg">
<meta property="og:updated_time" content="2018-10-26T06:23:37.047Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第七篇之Spring Transaction">
<meta name="twitter:description" content="数据库事务概念 数据库事务(Database Transaction) ，是指作为单个逻辑工作单元执行的一系列操作，要么完全地执行，要么完全地不执行。  相关属性   名称 解释     原子性(Atomicity) 事务必须是原子工作单元。对于其数据修改，要么全都执行，要么全都不执行   一致性(Consistency) 事务在完成时，必须使所有的数据都保持一致状态   隔离性(Isolatio">
<meta name="twitter:image" content="http://loveyy.net/images/spring/1/spring_transaction.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>
<script>
    (function(){
        if(''){
            if (prompt('这是私人日志,请输入文章密码') !== ''){
                alert('亲,密码错误,请联系作者!');
                history.back();
            }
        }
    })();
</script>



  <link rel="canonical" href="http://loveyy.net/2017/06/07/编程/spring/第七篇之Spring Transaction/"/>





  <title>第七篇之Spring Transaction | 燕良山好汉的博客</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0de31a9b94e2d0af07ff23b34a742643";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">燕良山好汉的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://loveyy.net/2017/06/07/编程/spring/第七篇之Spring Transaction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Andrew Song">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="燕良山好汉的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                第七篇之Spring Transaction
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-07T11:12:00+08:00">
                2017-06-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring的那点事/" itemprop="url" rel="index">
                    <span itemprop="name">Spring的那点事</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a class="cloud-tie-join-count" href="/2017/06/07/编程/spring/第七篇之Spring Transaction/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count join-count" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="数据库事务概念"><a href="#数据库事务概念" class="headerlink" title="数据库事务概念"></a>数据库事务概念</h2><blockquote>
<p>数据库事务(Database Transaction) ，是指作为单个逻辑工作单元执行的一系列操作，要么完全地执行，要么完全地不执行。</p>
</blockquote>
<h3 id="相关属性"><a href="#相关属性" class="headerlink" title="相关属性"></a>相关属性</h3><table>
<thead>
<tr>
<th>名称</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>原子性(Atomicity)</td>
<td>事务必须是原子工作单元。对于其数据修改，要么全都执行，要么全都不执行</td>
</tr>
<tr>
<td>一致性(Consistency)</td>
<td>事务在完成时，必须使所有的数据都保持一致状态</td>
</tr>
<tr>
<td>隔离性(Isolation)</td>
<td>由并发事务所作的修改必须与任何其它并发事务所作的修改隔离，这需要事务隔离级别来指定隔离性</td>
</tr>
<tr>
<td>持久性(Durability)</td>
<td>事务完成之后，它对于系统的影响是永久性的</td>
</tr>
</tbody>
</table>
<h3 id="隔离级别"><a href="#隔离级别" class="headerlink" title="隔离级别"></a>隔离级别</h3><p>在数据库操作中，为了有效保证并发读取数据的正确性，提出的事务隔离级别。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>未提交读(Read Uncommitted)</td>
<td>最低隔离级别，一个事务能读取到别的事务未提交的更新数据，很不安全，可能出现丢失更新、脏读、不可重复读、幻读</td>
</tr>
<tr>
<td>提交读(Read Committed)</td>
<td>一个事务能读取到别的事务提交的更新数据，不能看到未提交的更新数据，不可能出现丢失更新、脏读，但可能出现不可重复读、幻读</td>
</tr>
<tr>
<td>可重复读(Repeatable Read)</td>
<td>保证同一事务中先后执行的多次查询将返回同一结果，不受其他事务影响，不可能出现丢失更新、脏读、不可重复读，但可能出现幻读</td>
</tr>
<tr>
<td>序列化(Serializable)</td>
<td>最高隔离级别，不允许事务并发执行，而必须串行化执行，最安全，不可能出现更新、脏读、不可重复读、幻读</td>
</tr>
</tbody>
</table>
<blockquote>
<p>隔离级别越高，越能保证数据的完整性和一致性，但是对并发性能的影响也越大。对于多数应用程序，可以优先考虑把数据库系统的隔离级别设为Read Committed。它能够避免脏读取，而且具有较好的并发性能。尽管它会导致不可重复读、幻读和第二类丢失更新这些并发问题，在可能出现这类问题的个别场合，可以由应用程序采用悲观锁或乐观锁来控制。</p>
</blockquote>
<h2 id="Spring提供的事务管理"><a href="#Spring提供的事务管理" class="headerlink" title="Spring提供的事务管理"></a>Spring提供的事务管理</h2><p>Spring并不直接管理事务，而是提供了多种事务管理器，将事务管理的职责委托给Hibernate或者JTA等持久化机制所提供的相关平台框架的事务来实现</p>
<p>Spring事务管理涉及的接口的如下<br><img src="\images\spring\1\spring_transaction.jpg" alt="image"><br>图片来源于网络</p>
<h3 id="PlatformTransactionManager接口"><a href="#PlatformTransactionManager接口" class="headerlink" title="PlatformTransactionManager接口"></a>PlatformTransactionManager接口</h3><h4 id="PlatformTransactionManager接口："><a href="#PlatformTransactionManager接口：" class="headerlink" title="PlatformTransactionManager接口："></a>PlatformTransactionManager接口：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">package org.springframework.transaction;</div><div class="line"></div><div class="line">public interface PlatformTransactionManager &#123;</div><div class="line"></div><div class="line">//返回一个已经激活的事务或创建一个新的事务（根据给定的TransactionDefinition类型参数定义的事务属性）</div><div class="line">TransactionStatus getTransaction(TransactionDefinition definition) throws TransactionException;</div><div class="line">//提交</div><div class="line">void commit(TransactionStatus status) throws TransactionException;</div><div class="line">//回滚</div><div class="line">void rollback(TransactionStatus status) throws TransactionException;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="TransactionDefinition接口"><a href="#TransactionDefinition接口" class="headerlink" title="TransactionDefinition接口"></a>TransactionDefinition接口</h4><p>这个接口提供定义事务属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">package org.springframework.transaction;</div><div class="line"></div><div class="line">import java.sql.Connection;</div><div class="line">public interface TransactionDefinition &#123;</div><div class="line"></div><div class="line">	int PROPAGATION_REQUIRED = 0;</div><div class="line"></div><div class="line">	int PROPAGATION_SUPPORTS = 1;</div><div class="line">	</div><div class="line">	int PROPAGATION_MANDATORY = 2;</div><div class="line"></div><div class="line">	int PROPAGATION_REQUIRES_NEW = 3;</div><div class="line"></div><div class="line">	int PROPAGATION_NOT_SUPPORTED = 4;</div><div class="line"></div><div class="line">	int PROPAGATION_NEVER = 5;</div><div class="line"></div><div class="line">	int PROPAGATION_NESTED = 6;</div><div class="line"></div><div class="line">	int ISOLATION_DEFAULT = -1;</div><div class="line"></div><div class="line">	int ISOLATION_READ_UNCOMMITTED = Connection.TRANSACTION_READ_UNCOMMITTED;</div><div class="line">	</div><div class="line">	int ISOLATION_READ_COMMITTED = Connection.TRANSACTION_READ_COMMITTED;</div><div class="line"></div><div class="line">	int ISOLATION_REPEATABLE_READ = Connection.TRANSACTION_REPEATABLE_READ;</div><div class="line"></div><div class="line">	int ISOLATION_SERIALIZABLE = Connection.TRANSACTION_SERIALIZABLE;</div><div class="line"></div><div class="line">	int TIMEOUT_DEFAULT = -1;</div><div class="line">    //返回定义的事务传播行为</div><div class="line">	int getPropagationBehavior();</div><div class="line">    //返回定义的事务隔离级别</div><div class="line">	int getIsolationLevel();</div><div class="line">    //返回定义的事务超时时间</div><div class="line">	int getTimeout();</div><div class="line">    //返回定义的事务是否是只读的</div><div class="line">	boolean isReadOnly();</div><div class="line">    //返回定义的事务名字</div><div class="line">	String getName();</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="TransactionStatus接口"><a href="#TransactionStatus接口" class="headerlink" title="TransactionStatus接口"></a>TransactionStatus接口</h4><p>这个接口提供简单的控制事务执行和查询事务状态的方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">package org.springframework.transaction;</div><div class="line">import java.io.Flushable;</div><div class="line">public interface TransactionStatus extends SavepointManager, Flushable &#123;</div><div class="line">    //返回当前事务状态是否是新事务</div><div class="line">	boolean isNewTransaction();</div><div class="line">    //返回当前事务是否有保存点</div><div class="line">	boolean hasSavepoint();</div><div class="line">    //设置当前事务应该回滚</div><div class="line">	void setRollbackOnly();</div><div class="line">    //回当前事务是否应该回滚</div><div class="line">	boolean isRollbackOnly();</div><div class="line">    //用于刷新底层会话中的修改到数据库，一般用于刷新如Hibernate/JPA的会话，可能对如JDBC类型的事务无任何影响</div><div class="line">	@Override</div><div class="line">	void flush();</div><div class="line">    //当前事务否已经完成</div><div class="line">	boolean isCompleted();</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Spring内置事务管理器实现"><a href="#Spring内置事务管理器实现" class="headerlink" title="Spring内置事务管理器实现"></a>Spring内置事务管理器实现</h3><table>
<thead>
<tr>
<th>名称</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>DataSourceTransactionManager</td>
<td>位于org.springframework.jdbc.datasource包中，数据源事务管理器，提供对单个javax.sql.DataSource事务管理，用于Spring JDBC抽象框架、iBATIS或MyBatis框架的事务管理</td>
</tr>
<tr>
<td>JdoTransactionManager</td>
<td>位于org.springframework.orm.jdo包中，提供对单个javax.jdo.PersistenceManagerFactory事务管理，用于集成JDO框架时的事务管理</td>
</tr>
<tr>
<td>JpaTransactionManager</td>
<td>位于org.springframework.orm.jpa包中，提供对单个javax.persistence.EntityManagerFactory事务支持，用于集成JPA实现框架时的事务管理</td>
</tr>
<tr>
<td>HibernateTransactionManager</td>
<td>于org.springframework.orm.hibernate3包中，提供对单个org.hibernate.SessionFactory事务支持，用于集成Hibernate框架时的事务管理</td>
</tr>
<tr>
<td>JtaTransactionManager</td>
<td>位于org.springframework.transaction.jta包中，提供对分布式事务管理的支持，并将事务管理委托给Java EE应用服务器事务管理器</td>
</tr>
<tr>
<td>OC4JjtaTransactionManager</td>
<td>位于org.springframework.transaction.jta包中，Spring提供的对OC4J10.1.3+应用服务器事务管理器的适配器，此适配器用于对应用服务器提供的高级事务的支持</td>
</tr>
<tr>
<td>WebSphereUowTransactionManager</td>
<td>位于org.springframework.transaction.jta包中，Spring提供的对WebSphere 6.0+应用服务器事务管理器的适配器，此适配器用于对应用服务器提供的高级事务的支持</td>
</tr>
<tr>
<td>WebLogicJtaTransactionManager</td>
<td>位于org.springframework.transaction.jta包中，Spring提供的对WebLogic 8.1+应用服务器事务管理器的适配器，此适配器用于对应用服务器提供的高级事务的支持</td>
</tr>
</tbody>
</table>
<h3 id="Spring事务属性"><a href="#Spring事务属性" class="headerlink" title="Spring事务属性"></a>Spring事务属性</h3><p>事务管理器接口PlatformTransactionManager通过getTransaction(TransactionDefinition definition)方法来得到事务，这个方法里面的参数是TransactionDefinition类，这个类就定义了一些基本的事务属性</p>
<h4 id="传播行为"><a href="#传播行为" class="headerlink" title="传播行为"></a>传播行为</h4><p>事务的第一个方面是传播行为（propagation behavior）。当事务方法被另一个事务方法调用时，必须指定事务应该如何传播。例如：方法可能继续在现有事务中运行，也可能开启一个新事务，并在自己的事务中运行。</p>
<p>Spring定义了七种传播行为：</p>
<table>
<thead>
<tr>
<th>传播行为</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>PROPAGATION_REQUIRED</td>
<td>表示当前方法必须运行在事务中。如果当前事务存在，方法将会在该事务中运行。否则，会启动一个新的事务</td>
</tr>
<tr>
<td>PROPAGATION_SUPPORTS</td>
<td>表示当前方法不需要事务上下文，但是如果存在当前事务的话，那么该方法会在这个事务中运行</td>
</tr>
<tr>
<td>PROPAGATION_MANDATORY</td>
<td>表示该方法必须在事务中运行，如果当前事务不存在，则会抛出一个异常</td>
</tr>
<tr>
<td>PROPAGATION_REQUIRED_NEW</td>
<td>表示当前方法必须运行在它自己的事务中。一个新的事务将被启动。如果存在当前事务，在该方法执行期间，当前事务会被挂起。如果使用JTATransactionManager的话，则需要访问TransactionManager</td>
</tr>
<tr>
<td>PROPAGATION_NOT_SUPPORTED</td>
<td>表示该方法不应该运行在事务中。如果存在当前事务，在该方法运行期间，当前事务将被挂起。如果使用JTATransactionManager的话，则需要访问TransactionManager</td>
</tr>
<tr>
<td>PROPAGATION_NEVER</td>
<td>表示当前方法不应该运行在事务上下文中。如果当前正有一个事务在运行，则会抛出异常</td>
</tr>
<tr>
<td>PROPAGATION_NESTED</td>
<td>表示如果当前已经存在一个事务，那么该方法将会在嵌套事务中运行。嵌套的事务可以独立于当前事务进行单独地提交或回滚。如果当前事务不存在，那么其行为与PROPAGATION_REQUIRED一样。</td>
</tr>
</tbody>
</table>
<h4 id="隔离级别-1"><a href="#隔离级别-1" class="headerlink" title="隔离级别"></a>隔离级别</h4><p>隔离级别定义了一个事务可能受其他并发事务影响的程度</p>
<table>
<thead>
<tr>
<th>隔离级别</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>ISOLATION_DEFAULT</td>
<td>默认隔离级别，即使用底层数据库默认的隔离级别</td>
</tr>
<tr>
<td>ISOLATION_READ_UNCOMMITTED</td>
<td>未提交读；</td>
</tr>
<tr>
<td>ISOLATION_READ_COMMITTED</td>
<td>提交读，一般情况下我们使用这个</td>
</tr>
<tr>
<td>ISOLATION_REPEATABLE_READ</td>
<td>可重复读</td>
</tr>
<tr>
<td>ISOLATION_SERIALIZABLE</td>
<td>序列化</td>
</tr>
</tbody>
</table>
<h2 id="Spring事务测试"><a href="#Spring事务测试" class="headerlink" title="Spring事务测试"></a>Spring事务测试</h2><blockquote>
<p>Spring提供了对编程式事务和声明式事务的支持，编程式事务允许用户在代码中精确定义事务的边界，而声明式事务（基于AOP）有助于用户将操作与事务规则进行解耦。<br>简单地说，编程式事务侵入到了业务代码里面，但是提供了更加详细的事务管理；而声明式事务由于基于AOP，所以既能起到事务管理的作用，又可以不影响业务代码的具体实现。</p>
</blockquote>
<h3 id="编程式事务"><a href="#编程式事务" class="headerlink" title="编程式事务"></a>编程式事务</h3><p>Spring提供两种方式的编程式事务管理，分别是：</p>
<p>1.使用PlatformTransactionManager</p>
<p>2.使用TransactionTemplate</p>
<blockquote>
<p>TransactionTemplate模板类用于简化事务管理，事务管理由模板类定义，而具体操作需要通过TransactionCallback回调接口或TransactionCallbackWithoutResult回调接口指定，通过调用模板类的参数类型为TransactionCallback或TransactionCallbackWithoutResult的execute方法来自动享受事务管理，TransactionTemplate是线程安全的。</p>
</blockquote>
<h4 id="使用PlatformTransactionManager"><a href="#使用PlatformTransactionManager" class="headerlink" title="使用PlatformTransactionManager"></a>使用PlatformTransactionManager</h4><h5 id="xml配置"><a href="#xml配置" class="headerlink" title="xml配置"></a>xml配置</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 定义一个某个框架平台的TransactionManager,此处使用JDBC --&gt;</div><div class="line"> &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;    </div><div class="line">    &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;  </div><div class="line">&lt;/bean&gt;</div></pre></td></tr></table></figure>
<h5 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">@Test</div><div class="line">public void testPlatformTransactionManager()&#123;</div><div class="line"> 	PlatformTransactionManager ptm = ac.getBean(&quot;transactionManager&quot;,PlatformTransactionManager.class);</div><div class="line"> 	UserServiceImpl userDaoImpl = ac.getBean(&quot;userServiceImpl&quot;,UserServiceImpl.class);</div><div class="line"> 	//定义事务属性</div><div class="line"> 	DefaultTransactionDefinition dtd = new DefaultTransactionDefinition();</div><div class="line"> 	//设置隔离级别</div><div class="line"> 	dtd.setIsolationLevel(DefaultTransactionDefinition.ISOLATION_DEFAULT);</div><div class="line">	//设置传播行为</div><div class="line"> 	dtd.setPropagationBehavior(DefaultTransactionDefinition.PROPAGATION_REQUIRED);</div><div class="line"> 	//获取事务状态</div><div class="line"> 	TransactionStatus ts = ptm.getTransaction(dtd);</div><div class="line">	List&lt;Map&lt;String, Object&gt;&gt; queryUser;</div><div class="line">	try &#123;</div><div class="line">		//业务逻辑的处理</div><div class="line">		queryUser = userDaoImpl.queryUser();</div><div class="line">		System.out.println(&quot;testMapperFactoryBean:&quot;+queryUser.toString());</div><div class="line">		//提交</div><div class="line">		ptm.commit(ts);</div><div class="line">	&#125; catch (Exception e) &#123;</div><div class="line">		//回滚</div><div class="line">		ptm.rollback(ts);</div><div class="line">	&#125;	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="使用TransactionTemplate"><a href="#使用TransactionTemplate" class="headerlink" title="使用TransactionTemplate"></a>使用TransactionTemplate</h4><h5 id="xml配置-1"><a href="#xml配置-1" class="headerlink" title="xml配置"></a>xml配置</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 定义一个某个框架平台的TransactionManager,此处使用JDBC --&gt;</div><div class="line"> &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;    </div><div class="line">    &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;  </div><div class="line">&lt;/bean&gt; </div><div class="line"></div><div class="line">&lt;!-- 使用TransactionTemplate --&gt;</div><div class="line">&lt;bean id=&quot;transactionTemplate&quot; class=&quot;org.springframework.transaction.support.TransactionTemplate&quot;&gt;</div><div class="line">	&lt;!-- 设置transactionManager --&gt;</div><div class="line">	&lt;constructor-arg name=&quot;transactionManager&quot; ref=&quot;transactionManager&quot;&gt;&lt;/constructor-arg&gt;</div><div class="line">&lt;/bean&gt;</div></pre></td></tr></table></figure>
<h5 id="测试代码-1"><a href="#测试代码-1" class="headerlink" title="测试代码"></a>测试代码</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">@Test</div><div class="line">public void testTransactionTemplate()&#123;</div><div class="line">	UserServiceImpl userDaoImpl = ac.getBean(&quot;userServiceImpl&quot;,UserServiceImpl.class);</div><div class="line">	TransactionTemplate tt = ac.getBean(&quot;transactionTemplate&quot;,TransactionTemplate.class);</div><div class="line">			List&lt;Map&lt;String, Object&gt;&gt; queryUser = tt.execute(new TransactionCallback&lt;List&lt;Map&lt;String, Object&gt;&gt;&gt;() &#123;</div><div class="line"></div><div class="line">		@Override</div><div class="line">		public List&lt;Map&lt;String, Object&gt;&gt; doInTransaction(TransactionStatus status) &#123;</div><div class="line">			//业务逻辑的处理</div><div class="line">			try &#123;</div><div class="line">				return userDaoImpl.queryUser();</div><div class="line">			&#125; catch (Exception e) &#123;</div><div class="line">				//异常回滚</div><div class="line">				status.setRollbackOnly();</div><div class="line">			&#125;</div><div class="line">			return null;</div><div class="line">		&#125;</div><div class="line">	&#125;);</div><div class="line">	System.out.println(&quot;testTransactionTemplate:&quot;+queryUser.toString());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="声明式事务"><a href="#声明式事务" class="headerlink" title="声明式事务"></a>声明式事务</h3><blockquote>
<p>声明式事务支持，使用该方式后最大的获益是简单，事务管理不再是令人痛苦的，而且此方式属于无侵入式，对业务逻辑实现无影响。</p>
</blockquote>
<h4 id="xml配置-2"><a href="#xml配置-2" class="headerlink" title="xml配置"></a>xml配置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 定义一个某个框架平台的TransactionManager,此处使用JDBC --&gt;</div><div class="line">&lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;    </div><div class="line">    &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;  </div><div class="line">&lt;/bean&gt; </div><div class="line"></div><div class="line"></div><div class="line">&lt;!-- ****************************声明式事务***************************************** --&gt;</div><div class="line">&lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;transactionManager&quot;&gt;</div><div class="line">	&lt;tx:attributes&gt;</div><div class="line">		&lt;tx:method name=&quot;update*&quot; propagation=&quot;REQUIRED&quot; isolation=&quot;DEFAULT&quot;/&gt;</div><div class="line">		&lt;tx:method name=&quot;*&quot; propagation=&quot;REQUIRED&quot; isolation=&quot;DEFAULT&quot; read-only=&quot;true&quot;/&gt;</div><div class="line">	&lt;/tx:attributes&gt;</div><div class="line">&lt;/tx:advice&gt;</div><div class="line"></div><div class="line">&lt;aop:config proxy-target-class=&quot;true&quot;&gt;</div><div class="line">	&lt;aop:pointcut expression=&quot;execution(* com.szl.springorm.service.impl.*.*(..))&quot; id=&quot;txPointcut&quot;/&gt;</div><div class="line">	&lt;aop:advisor advice-ref=&quot;txAdvice&quot; pointcut-ref=&quot;txPointcut&quot;/&gt;</div><div class="line">&lt;/aop:config&gt;</div></pre></td></tr></table></figure>
<h4 id="测试代码-2"><a href="#测试代码-2" class="headerlink" title="测试代码"></a>测试代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">/**</div><div class="line"> * 声明式事务测试</div><div class="line"> * @author SongZhangLiang</div><div class="line"> */</div><div class="line">@Test</div><div class="line">public void testTransaction()&#123;</div><div class="line">	UserServiceImpl userDaoImpl = ac.getBean(&quot;userServiceImpl&quot;,UserServiceImpl.class);</div><div class="line">	List&lt;Map&lt;String, Object&gt;&gt; queryUser = userDaoImpl.queryUser();</div><div class="line">	System.out.println(&quot;testPlatformTransactionManager:&quot;+queryUser.toString());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="声明式事务XML配置详解"><a href="#声明式事务XML配置详解" class="headerlink" title="声明式事务XML配置详解"></a>声明式事务XML配置详解</h4><table>
<thead>
<tr>
<th>属性</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;tx:advice</code></td>
<td>事务通知定义，用于指定事务属性，其中<code>transaction-manager</code>属性指定事务管理器，并通过<code>&lt;tx:attributes &gt;</code>指定具体需要拦截的方法</td>
</tr>
<tr>
<td><code>&lt;tx:method name=&quot;update*&quot;&gt;</code></td>
<td>表示将拦截以update开头的方法，被拦截的方法将应用配置的事务属性：propagation=”REQUIRED”表示传播行为是Required，isolation=”DEFAULT”表示隔离级别依赖底层事务系统</td>
</tr>
<tr>
<td><code>&lt;tx:method name=&quot;*&quot;&gt;</code></td>
<td>表示将拦截其他所有方法，被拦截的方法将应用配置的事务属性：propagation=”REQUIRED”表示传播行为是Required，isolation=”DEFAULT”表示隔离级别依赖底层事务系统，read-only=”true”表示事务只读</td>
</tr>
<tr>
<td><code>&lt;aop:config&gt;</code></td>
<td>AOP相关配置</td>
</tr>
<tr>
<td><code>&lt;aop:pointcut/&gt;</code></td>
<td>切入点定义，定义名为”serviceMethod”的aspectj切入点，切入点表达式为<code>execution(* com.szl.springorm.service.impl.*.*(..))</code>表示拦截impl包及子包下的任何类的任何方法</td>
</tr>
<tr>
<td><code>&lt;aop:advisor&gt;</code></td>
<td>Advisor定义，其中切入点为txPointcut，通知为txAdvice</td>
</tr>
</tbody>
</table>
<h3 id="Transactional实现事务管理"><a href="#Transactional实现事务管理" class="headerlink" title="@Transactional实现事务管理"></a>@Transactional实现事务管理</h3><blockquote>
<p>对声明式事务管理，Spring提供基于@Transactional注解方式来实现，但需要Java 5+。<br> 注解方式是最简单的事务配置方式，可以直接在Java源代码中声明事务属性，且对于每一个业务类或方法如果需要事务都必须使用此注解。</p>
</blockquote>
<h4 id="XML配置"><a href="#XML配置" class="headerlink" title="XML配置"></a>XML配置</h4><p>配置支持声明式事务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot;/&gt;</div></pre></td></tr></table></figure>
<h4 id="业务代码"><a href="#业务代码" class="headerlink" title="业务代码"></a>业务代码</h4><p>业务逻辑层代码，我们在方法上使用<code>@Transactional</code>注解<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@Transactional</div><div class="line">@Override</div><div class="line">public List&lt;Map&lt;String, Object&gt;&gt; queryUser() &#123;</div><div class="line">	return userDao1.queryUser();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="测试代码-3"><a href="#测试代码-3" class="headerlink" title="测试代码"></a>测试代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * 声明式事务测试_注解</div><div class="line"> * @author SongZhangLiang</div><div class="line"> */</div><div class="line">@Test</div><div class="line">public void testTransactionAnnotation()&#123;</div><div class="line">	com.szl.springtransaction.service.impl.UserServiceImpl userDaoImpl = ac.getBean(&quot;userServiceImpl1&quot;,com.szl.springtransaction.service.impl.UserServiceImpl.class);</div><div class="line">	List&lt;Map&lt;String, Object&gt;&gt; queryUser = userDaoImpl.queryUser();</div><div class="line">	System.out.println(&quot;testTransactionAnnotation:&quot;+queryUser.toString());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Transactional配置介绍"><a href="#Transactional配置介绍" class="headerlink" title="@Transactional配置介绍"></a>@Transactional配置介绍</h4><p>Spring提供的<code>&lt;tx:annotation-driven/&gt;</code>用于开启对注解事务管理的支持，从而能识别Bean类上的@Transactional注解元数据，其具有以下属性：</p>
<ul>
<li>transaction-manager：指定事务管理器名字，默认为transactionManager，当使用其他名字时需要明确指定</li>
<li>proxy-target-class：表示将使用的代码机制，默认false表示使用JDK代理，如果为true将使用CGLIB代理</li>
<li>order：定义事务通知顺序，默认Ordered.LOWEST_PRECEDENCE，表示将顺序决定权交给AOP来处理。</li>
</ul>
<p>Spring使用<code>@Transaction</code>来指定事务属性，可以在接口、类或方法上指定，如果类和方法上都指定了<code>@Transaction</code>，则方法上的事务属性被优先使用，具体属性如下：</p>
<ul>
<li>value：指定事务管理器名字，默认使用<code>&lt;tx:annotation-driven/&gt;</code>指定的事务管理器，用于支持多事务管理器环境</li>
<li>propagation：指定事务传播行为，默认为Required，使用Propagation.REQUIRED指定</li>
<li>isolation：指定事务隔离级别，默认为“DEFAULT”，使用Isolation.DEFAULT指定</li>
<li>readOnly：指定事务是否只读，默认false表示事务非只读</li>
<li>timeout：指定事务超时时间，以秒为单位，默认-1表示事务超时将依赖于底层事务系统</li>
<li>rollbackFor：指定一组异常类，遇到该类异常将回滚事务</li>
<li>rollbackForClassname：指定一组异常类名字，其含义与<code>&lt;tx:method&gt;</code>中的rollback-for属性语义完全一样</li>
<li>noRollbackFor：指定一组异常类，即使遇到该类异常也将提交事务，即不回滚事务</li>
<li>noRollbackForClassname：指定一组异常类名字，其含义与<code>&lt;tx:method&gt;</code>中的no-rollback-for属性语义完全一样</li>
</ul>
<h4 id="Transactional注意事项"><a href="#Transactional注意事项" class="headerlink" title="@Transactional注意事项"></a>@Transactional注意事项</h4><ul>
<li>如果在接口、实现类或方法上都指定了@Transactional 注解，则优先级顺序为方法&gt;实现类&gt;接口</li>
<li>默认只对RuntimeException异常回滚</li>
<li>在使用Spring代理时，默认只有在public可见度的方法的@Transactional 注解才是有效的，其它可见度（protected、private、包可见）的方法上即使有@Transactional 注解也不会应用这些事务属性的，Spring也不会报错，如果你非要使用非公共方法注解事务管理的话，可考虑使用AspectJ</li>
</ul>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Spring/" rel="tag"># Spring</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/06/15/编程/spring/第八篇之Spirng WEB/" rel="next" title="第八篇之Spirng WEB">
                <i class="fa fa-chevron-left"></i> 第八篇之Spirng WEB
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/06/05/编程/spring/第六篇之Spring ORM/" rel="prev" title="第六篇之Spring ORM">
                第六篇之Spring ORM <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="Andrew Song" />
          <p class="site-author-name" itemprop="name">Andrew Song</p>
           
              <p class="site-description motion-element" itemprop="description">只要开始,就不晚!</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">18</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.csdn.net/" title="CSDN" target="_blank">CSDN</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/" title="CNBLOG" target="_blank">CNBLOG</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库事务概念"><span class="nav-number">1.</span> <span class="nav-text">数据库事务概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#相关属性"><span class="nav-number">1.1.</span> <span class="nav-text">相关属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#隔离级别"><span class="nav-number">1.2.</span> <span class="nav-text">隔离级别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring提供的事务管理"><span class="nav-number">2.</span> <span class="nav-text">Spring提供的事务管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#PlatformTransactionManager接口"><span class="nav-number">2.1.</span> <span class="nav-text">PlatformTransactionManager接口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#PlatformTransactionManager接口："><span class="nav-number">2.1.1.</span> <span class="nav-text">PlatformTransactionManager接口：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TransactionDefinition接口"><span class="nav-number">2.1.2.</span> <span class="nav-text">TransactionDefinition接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TransactionStatus接口"><span class="nav-number">2.1.3.</span> <span class="nav-text">TransactionStatus接口</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring内置事务管理器实现"><span class="nav-number">2.2.</span> <span class="nav-text">Spring内置事务管理器实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring事务属性"><span class="nav-number">2.3.</span> <span class="nav-text">Spring事务属性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#传播行为"><span class="nav-number">2.3.1.</span> <span class="nav-text">传播行为</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#隔离级别-1"><span class="nav-number">2.3.2.</span> <span class="nav-text">隔离级别</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring事务测试"><span class="nav-number">3.</span> <span class="nav-text">Spring事务测试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#编程式事务"><span class="nav-number">3.1.</span> <span class="nav-text">编程式事务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#使用PlatformTransactionManager"><span class="nav-number">3.1.1.</span> <span class="nav-text">使用PlatformTransactionManager</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#xml配置"><span class="nav-number">3.1.1.1.</span> <span class="nav-text">xml配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#测试代码"><span class="nav-number">3.1.1.2.</span> <span class="nav-text">测试代码</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用TransactionTemplate"><span class="nav-number">3.1.2.</span> <span class="nav-text">使用TransactionTemplate</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#xml配置-1"><span class="nav-number">3.1.2.1.</span> <span class="nav-text">xml配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#测试代码-1"><span class="nav-number">3.1.2.2.</span> <span class="nav-text">测试代码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#声明式事务"><span class="nav-number">3.2.</span> <span class="nav-text">声明式事务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#xml配置-2"><span class="nav-number">3.2.1.</span> <span class="nav-text">xml配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#测试代码-2"><span class="nav-number">3.2.2.</span> <span class="nav-text">测试代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#声明式事务XML配置详解"><span class="nav-number">3.2.3.</span> <span class="nav-text">声明式事务XML配置详解</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Transactional实现事务管理"><span class="nav-number">3.3.</span> <span class="nav-text">@Transactional实现事务管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#XML配置"><span class="nav-number">3.3.1.</span> <span class="nav-text">XML配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#业务代码"><span class="nav-number">3.3.2.</span> <span class="nav-text">业务代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#测试代码-3"><span class="nav-number">3.3.3.</span> <span class="nav-text">测试代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Transactional配置介绍"><span class="nav-number">3.3.4.</span> <span class="nav-text">@Transactional配置介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Transactional注意事项"><span class="nav-number">3.3.5.</span> <span class="nav-text">@Transactional注意事项</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Andrew Song</span>
</div>

<!-- 
<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>
 -->

        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  
    
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "a65e94b0556544308ae1a6ec892f9609",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
  










  





  

  

  

  

  

</body>
</html>
